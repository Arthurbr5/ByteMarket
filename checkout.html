<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Compra - ByteMarket</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="index.html"><h1>ByteMarket</h1></a>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="explorar.html">Explorar</a></li>
                <li><a href="carrinho.html">üõí Carrinho</a></li>
            </ul>
        </div>
    </nav>

    <section class="checkout-section">
        <div class="container">
            <div class="checkout-header">
                <h2>Finalizar Compra</h2>
                <div class="checkout-steps">
                    <div class="step active">
                        <span class="step-number">1</span>
                        <span>Dados</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <span>Pagamento</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>Confirma√ß√£o</span>
                    </div>
                </div>
            </div>

            <div class="checkout-layout">
                <div class="checkout-main">
                    <!-- Etapa 1: Dados -->
                    <div class="checkout-step" id="step1">
                        <div class="checkout-card">
                            <h3>Seus Dados</h3>
                            <form id="checkoutForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Nome Completo *</label>
                                        <input type="text" required placeholder="Jo√£o Silva">
                                    </div>
                                    <div class="form-group">
                                        <label>CPF *</label>
                                        <input type="text" required placeholder="000.000.000-00">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Email *</label>
                                    <input type="email" required placeholder="seu@email.com">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Telefone/WhatsApp *</label>
                                        <input type="tel" required placeholder="(00) 00000-0000">
                                    </div>
                                    <div class="form-group">
                                        <label>CEP</label>
                                        <input type="text" placeholder="00000-000">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="saveInfo">
                                        <span>Salvar informa√ß√µes para pr√≥ximas compras</span>
                                    </label>
                                </div>

                                <button type="button" class="btn btn-primary btn-block" onclick="nextStep(2)">
                                    Continuar para Pagamento ‚Üí
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Etapa 2: Pagamento -->
                    <div class="checkout-step" id="step2" style="display: none;">
                        <div class="checkout-card">
                            <h3>Forma de Pagamento</h3>

                            <div class="payment-methods">
                                <div class="payment-option" onclick="selectPayment('pix')">
                                    <input type="radio" name="payment" id="pix" value="pix">
                                    <label for="pix">
                                        <div class="payment-icon">üí≥</div>
                                        <div class="payment-info">
                                            <strong>PIX</strong>
                                            <p>Aprova√ß√£o instant√¢nea</p>
                                        </div>
                                        <div class="payment-badge">Recomendado</div>
                                    </label>
                                </div>

                                <div class="payment-option" onclick="selectPayment('card')">
                                    <input type="radio" name="payment" id="card" value="card">
                                    <label for="card">
                                        <div class="payment-icon">üí≥</div>
                                        <div class="payment-info">
                                            <strong>Cart√£o de Cr√©dito</strong>
                                            <p>Parcelamento em at√© 12x</p>
                                        </div>
                                    </label>
                                </div>

                                <div class="payment-option" onclick="selectPayment('boleto')">
                                    <input type="radio" name="payment" id="boleto" value="boleto">
                                    <label for="boleto">
                                        <div class="payment-icon">üìÑ</div>
                                        <div class="payment-info">
                                            <strong>Boleto Banc√°rio</strong>
                                            <p>Vencimento em 3 dias √∫teis</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- PIX Details -->
                            <div id="pixDetails" class="payment-details" style="display: none;">
                                <div class="pix-info">
                                    <h4>Pagamento via PIX</h4>
                                    <p>Ao confirmar, voc√™ receber√° um QR Code para pagamento instant√¢neo</p>
                                    <div class="info-box">
                                        <p>‚úì Aprova√ß√£o imediata</p>
                                        <p>‚úì Acesso instant√¢neo aos produtos</p>
                                        <p>‚úì Sem taxas adicionais</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Card Details -->
                            <div id="cardDetails" class="payment-details" style="display: none;">
                                <h4>Dados do Cart√£o</h4>
                                <div class="form-group">
                                    <label>N√∫mero do Cart√£o *</label>
                                    <input type="text" placeholder="0000 0000 0000 0000" maxlength="19">
                                </div>
                                <div class="form-group">
                                    <label>Nome no Cart√£o *</label>
                                    <input type="text" placeholder="Nome como est√° no cart√£o">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Validade *</label>
                                        <input type="text" placeholder="MM/AA" maxlength="5">
                                    </div>
                                    <div class="form-group">
                                        <label>CVV *</label>
                                        <input type="text" placeholder="000" maxlength="4">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Parcelas *</label>
                                    <select>
                                        <option>1x de R$ 249,80 sem juros</option>
                                        <option>2x de R$ 124,90 sem juros</option>
                                        <option>3x de R$ 83,27 sem juros</option>
                                        <option>6x de R$ 41,63 sem juros</option>
                                        <option>12x de R$ 22,78 (total: R$ 273,36)</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Boleto Details -->
                            <div id="boletoDetails" class="payment-details" style="display: none;">
                                <div class="boleto-info">
                                    <h4>Pagamento via Boleto</h4>
                                    <div class="info-box info-warning">
                                        <p>‚ö†Ô∏è O boleto leva at√© 3 dias √∫teis para compensar</p>
                                        <p>‚ö†Ô∏è Voc√™ receber√° o acesso ap√≥s a confirma√ß√£o do pagamento</p>
                                    </div>
                                </div>
                            </div>

                            <div class="checkout-actions">
                                <button class="btn btn-secondary" onclick="nextStep(1)">
                                    ‚Üê Voltar
                                </button>
                                <button class="btn btn-primary" onclick="nextStep(3)">
                                    Continuar ‚Üí
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Etapa 3: Confirma√ß√£o -->
                    <div class="checkout-step" id="step3" style="display: none;">
                        <div class="checkout-card">
                            <div class="success-icon">‚úì</div>
                            <h3>Revis√£o do Pedido</h3>
                            
                            <div class="order-review">
                                <div class="review-section">
                                    <h4>Dados do Comprador</h4>
                                    <p><strong>Nome:</strong> Jo√£o Silva</p>
                                    <p><strong>Email:</strong> joao@email.com</p>
                                    <p><strong>CPF:</strong> 000.000.000-00</p>
                                </div>

                                <div class="review-section">
                                    <h4>Forma de Pagamento</h4>
                                    <p id="selectedPaymentMethod">PIX - Pagamento instant√¢neo</p>
                                </div>

                                <div class="review-section">
                                    <h4>Produtos</h4>
                                    <div class="review-products">
                                        <div class="review-product-item">
                                            <span>Bot de Automa√ß√£o Premium</span>
                                            <span>R$ 149,90</span>
                                        </div>
                                        <div class="review-product-item">
                                            <span>Curso Completo de Python</span>
                                            <span>R$ 99,90</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="terms-acceptance">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="acceptTerms" required>
                                    <span>Concordo com os <a href="#" class="link-text">Termos de Uso</a> e <a href="#" class="link-text">Pol√≠tica de Privacidade</a></span>
                                </label>
                            </div>

                            <div class="checkout-actions">
                                <button class="btn btn-secondary" onclick="nextStep(2)">
                                    ‚Üê Voltar
                                </button>
                                <button class="btn btn-primary btn-large" onclick="finalizePurchase()">
                                    üîí Finalizar Compra - R$ 249,80
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Etapa 4: PIX QR Code -->
                    <div class="checkout-step" id="step4" style="display: none;">
                        <div class="checkout-card text-center">
                            <h3>Escaneie o QR Code</h3>
                            <p>Use o app do seu banco para pagar</p>

                            <div class="qrcode-container">
                                <div class="qrcode-placeholder">
                                    <div class="qr-square"></div>
                                </div>
                            </div>

                            <div class="pix-copy-paste">
                                <p><strong>Ou copie o c√≥digo PIX:</strong></p>
                                <div class="copy-code-box">
                                    <code id="pixCode">00020126580014BR.GOV.BCB.PIX0136a629532e-7b34-4c...</code>
                                    <button class="btn btn-small" onclick="copyPixCode()">Copiar</button>
                                </div>
                            </div>

                            <div class="payment-timer">
                                <p>‚è±Ô∏è Expira em: <strong id="timer">14:59</strong></p>
                            </div>

                            <div class="info-box">
                                <p>Aguardando confirma√ß√£o do pagamento...</p>
                                <div class="loading-spinner"></div>
                            </div>

                            <button class="btn btn-secondary" onclick="cancelPayment()">
                                Cancelar e Voltar
                            </button>
                        </div>
                    </div>

                    <!-- Etapa 5: Sucesso -->
                    <div class="checkout-step" id="step5" style="display: none;">
                        <div class="checkout-card text-center">
                            <div class="success-icon-large">‚úì</div>
                            <h2>Pagamento Confirmado!</h2>
                            <p class="success-message">Seu pedido foi processado com sucesso</p>

                            <div class="order-number">
                                <p>N√∫mero do pedido: <strong>#8934</strong></p>
                            </div>

                            <div class="success-actions">
                                <a href="downloads.html" class="btn btn-primary btn-large">
                                    üì• Acessar Meus Downloads
                                </a>
                                <a href="painel.html" class="btn btn-secondary">
                                    Ver Painel
                                </a>
                                <a href="index.html" class="btn btn-secondary">
                                    Voltar para Home
                                </a>
                            </div>

                            <div class="info-box">
                                <p>üìß Enviamos um email com os detalhes da compra e links de download</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar Resumo -->
                <aside class="checkout-sidebar">
                    <div class="order-summary">
                        <h3>Resumo do Pedido</h3>
                        
                        <div class="summary-items">
                            <div class="summary-item">
                                <div class="item-info">
                                    <p class="item-title">Bot de Automa√ß√£o Premium</p>
                                    <p class="item-seller">por Jo√£o Silva</p>
                                </div>
                                <p class="item-price">R$ 149,90</p>
                            </div>

                            <div class="summary-item">
                                <div class="item-info">
                                    <p class="item-title">Curso Completo de Python</p>
                                    <p class="item-seller">por Ana Costa</p>
                                </div>
                                <p class="item-price">R$ 99,90</p>
                            </div>
                        </div>

                        <div class="coupon-section">
                            <input type="text" placeholder="C√≥digo de cupom" id="couponCode">
                            <button class="btn btn-small" onclick="applyCoupon()">Aplicar</button>
                        </div>

                        <div class="summary-totals">
                            <div class="total-line">
                                <span>Subtotal</span>
                                <span>R$ 249,80</span>
                            </div>
                            <div class="total-line discount">
                                <span>Desconto</span>
                                <span id="discountAmount">R$ 0,00</span>
                            </div>
                            <div class="total-line final">
                                <span>Total</span>
                                <span id="finalTotal">R$ 249,80</span>
                            </div>
                        </div>

                        <div class="security-badges">
                            <p>üîí Compra 100% segura</p>
                            <p>‚úì Garantia de 7 dias</p>
                            <p>‚úì Suporte dedicado</p>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <script src="script.js"></script>
    <script src="auth-simple.js"></script>
    <script src="app.js"></script>
    <script>
        let currentStep = 1;
        let selectedPayment = '';

        function nextStep(step) {
            // Hide all steps
            for (let i = 1; i <= 5; i++) {
                document.getElementById('step' + i).style.display = 'none';
            }
            
            // Show target step
            document.getElementById('step' + step).style.display = 'block';
            currentStep = step;
            
            // Update progress
            updateStepIndicators(step);
        }

        function updateStepIndicators(step) {
            const steps = document.querySelectorAll('.checkout-steps .step');
            steps.forEach((el, index) => {
                if (index + 1 <= step) {
                    el.classList.add('active');
                } else {
                    el.classList.remove('active');
                }
            });
        }

        function selectPayment(method) {
            selectedPayment = method;
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.getElementById(method).checked = true;
            
            // Hide all details
            document.querySelectorAll('.payment-details').forEach(detail => {
                detail.style.display = 'none';
            });
            
            // Show selected details
            document.getElementById(method + 'Details').style.display = 'block';
        }

        function finalizePurchase() {
            const acceptTerms = document.getElementById('acceptTerms').checked;
            if (!acceptTerms) {
                alert('Voc√™ precisa aceitar os termos para continuar');
                return;
            }
            
            if (selectedPayment === 'pix') {
                nextStep(4);
                startPixTimer();
                // Simular confirma√ß√£o ap√≥s 5 segundos
                setTimeout(() => {
                    nextStep(5);
                }, 5000);
            } else {
                // Para cart√£o e boleto, vai direto pro sucesso (simula√ß√£o)
                setTimeout(() => {
                    nextStep(5);
                }, 2000);
            }
        }

        function startPixTimer() {
            let time = 900; // 15 minutos
            const timerEl = document.getElementById('timer');
            
            const interval = setInterval(() => {
                const minutes = Math.floor(time / 60);
                const seconds = time % 60;
                timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                time--;
                
                if (time < 0) {
                    clearInterval(interval);
                    alert('O c√≥digo PIX expirou. Gerando um novo...');
                }
            }, 1000);
        }

        function copyPixCode() {
            const code = document.getElementById('pixCode').textContent;
            navigator.clipboard.writeText(code);
            alert('C√≥digo PIX copiado!');
        }

        function cancelPayment() {
            if (confirm('Deseja cancelar este pagamento?')) {
                nextStep(2);
            }
        }

        function applyCoupon() {
            const code = document.getElementById('couponCode').value;
            if (code.toUpperCase() === 'BYTE10') {
                document.getElementById('discountAmount').textContent = '- R$ 24,98';
                document.getElementById('finalTotal').textContent = 'R$ 224,82';
                alert('Cupom aplicado! 10% de desconto');
            } else {
                alert('Cupom inv√°lido');
            }
        }

        // Inicializar
        selectPayment('pix');
    </script>
</body>
</html>
